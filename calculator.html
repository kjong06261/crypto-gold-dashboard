<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Î≥µÎ¶¨ Î∞∞Îãπ ÏãúÎÆ¨Î†àÏù¥ÌÑ∞ | US Market Terminal</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0f1a;
            --bg-secondary: #111827;
            --bg-card: #1a2234;
            --bg-input: #0d1322;
            --accent-green: #10b981;
            --accent-green-glow: rgba(16, 185, 129, 0.3);
            --accent-blue: #3b82f6;
            --accent-purple: #8b5cf6;
            --accent-orange: #f59e0b;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-color: #1e293b;
            --border-glow: rgba(16, 185, 129, 0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Outfit', -apple-system, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        .simulator-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        /* Header */
        .simulator-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .simulator-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.15), rgba(59, 130, 246, 0.15));
            border: 1px solid var(--border-glow);
            padding: 8px 16px;
            border-radius: 100px;
            font-size: 12px;
            font-weight: 500;
            color: var(--accent-green);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 20px;
        }

        .simulator-badge::before {
            content: '';
            width: 8px;
            height: 8px;
            background: var(--accent-green);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
        }

        .simulator-title {
            font-size: clamp(28px, 5vw, 42px);
            font-weight: 700;
            background: linear-gradient(135deg, #fff 0%, #94a3b8 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 12px;
        }

        .simulator-subtitle {
            font-size: 16px;
            color: var(--text-secondary);
            max-width: 500px;
            margin: 0 auto;
        }

        /* Main Card */
        .simulator-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 
                0 4px 6px -1px rgba(0, 0, 0, 0.3),
                0 20px 40px -10px rgba(0, 0, 0, 0.4);
        }

        /* Input Section */
        .input-section {
            padding: 32px;
            background: linear-gradient(180deg, var(--bg-card) 0%, var(--bg-secondary) 100%);
        }

        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 24px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .input-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            font-weight: 500;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .input-label .icon {
            width: 16px;
            height: 16px;
            opacity: 0.7;
        }

        .input-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }

        .input-prefix {
            position: absolute;
            left: 16px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            color: var(--text-muted);
            pointer-events: none;
        }

        .input-suffix {
            position: absolute;
            right: 16px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            color: var(--text-muted);
            pointer-events: none;
        }

        .simulator-input {
            width: 100%;
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 14px 16px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 16px;
            font-weight: 500;
            color: var(--text-primary);
            transition: all 0.2s ease;
        }

        .simulator-input:focus {
            outline: none;
            border-color: var(--accent-green);
            box-shadow: 0 0 0 3px var(--accent-green-glow);
        }

        .simulator-input.has-prefix {
            padding-left: 36px;
        }

        .simulator-input.has-suffix {
            padding-right: 50px;
        }

        /* Calculate Button */
        .calculate-btn {
            width: 100%;
            margin-top: 28px;
            padding: 16px 32px;
            background: linear-gradient(135deg, var(--accent-green) 0%, #059669 100%);
            border: none;
            border-radius: 12px;
            font-family: 'Outfit', sans-serif;
            font-size: 16px;
            font-weight: 600;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .calculate-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s ease;
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px -10px rgba(16, 185, 129, 0.5);
        }

        .calculate-btn:hover::before {
            left: 100%;
        }

        .calculate-btn:active {
            transform: translateY(0);
        }

        /* Results Section */
        .results-section {
            padding: 32px;
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            display: none;
        }

        .results-section.active {
            display: block;
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .results-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .results-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .results-period {
            font-size: 13px;
            color: var(--text-muted);
            font-family: 'JetBrains Mono', monospace;
        }

        /* Result Cards */
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 16px;
            margin-bottom: 32px;
        }

        .result-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .result-card:hover {
            border-color: var(--accent-green);
            transform: translateY(-2px);
        }

        .result-card.highlight {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(59, 130, 246, 0.1) 100%);
            border-color: var(--accent-green);
        }

        .result-label {
            font-size: 12px;
            font-weight: 500;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .result-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 24px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .result-card.highlight .result-value {
            color: var(--accent-green);
        }

        .result-change {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            margin-top: 8px;
            padding: 4px 8px;
            background: rgba(16, 185, 129, 0.15);
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            color: var(--accent-green);
        }

        /* Monthly Dividend Display */
        .monthly-section {
            background: linear-gradient(135deg, var(--bg-card) 0%, rgba(16, 185, 129, 0.05) 100%);
            border: 1px solid var(--border-glow);
            border-radius: 16px;
            padding: 24px;
            text-align: center;
            margin-bottom: 24px;
        }

        .monthly-label {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .monthly-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 36px;
            font-weight: 700;
            color: var(--accent-green);
            text-shadow: 0 0 30px var(--accent-green-glow);
        }

        .monthly-note {
            font-size: 13px;
            color: var(--text-muted);
            margin-top: 8px;
        }

        /* Chart Container */
        .chart-container {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 24px;
        }

        .chart-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .chart-title {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .chart-legend {
            display: flex;
            gap: 16px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 12px;
            color: var(--text-muted);
        }

        .legend-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }

        .legend-dot.principal { background: var(--accent-blue); }
        .legend-dot.dividend { background: var(--accent-green); }

        .chart-area {
            height: 200px;
            position: relative;
        }

        .chart-bars {
            display: flex;
            align-items: flex-end;
            justify-content: space-between;
            height: 100%;
            padding: 0 10px;
            gap: 4px;
        }

        .bar-group {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            max-width: 60px;
        }

        .bar {
            width: 100%;
            border-radius: 4px 4px 0 0;
            position: relative;
            transition: all 0.5s ease;
        }

        .bar.principal {
            background: linear-gradient(180deg, var(--accent-blue) 0%, #1d4ed8 100%);
        }

        .bar.dividend {
            background: linear-gradient(180deg, var(--accent-green) 0%, #059669 100%);
        }

        .bar-label {
            font-size: 10px;
            color: var(--text-muted);
            font-family: 'JetBrains Mono', monospace;
        }

        /* Footer */
        .simulator-footer {
            padding: 20px 32px;
            background: var(--bg-primary);
            border-top: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 12px;
        }

        .footer-info {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: var(--text-muted);
        }

        .footer-update {
            font-family: 'JetBrains Mono', monospace;
            font-size: 11px;
            color: var(--text-muted);
        }

        /* Tooltip */
        .tooltip {
            position: relative;
            cursor: help;
        }

        .tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            padding: 8px 12px;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 12px;
            color: var(--text-secondary);
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.2s ease;
            z-index: 10;
        }

        .tooltip:hover::after {
            opacity: 1;
            visibility: visible;
        }

        /* Preset Buttons */
        .preset-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }

        .preset-label {
            font-size: 12px;
            color: var(--text-muted);
            margin-bottom: 12px;
        }

        .preset-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .preset-btn {
            padding: 8px 16px;
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-family: 'Outfit', sans-serif;
            font-size: 13px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .preset-btn:hover {
            border-color: var(--accent-green);
            color: var(--accent-green);
        }

        /* Responsive */
        @media (max-width: 600px) {
            .simulator-container {
                padding: 20px 16px;
            }

            .input-section, .results-section {
                padding: 24px 20px;
            }

            .monthly-value {
                font-size: 28px;
            }

            .result-value {
                font-size: 20px;
            }

            .chart-legend {
                flex-direction: column;
                gap: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="simulator-container">
        <!-- Header -->
        <header class="simulator-header">
            <div class="simulator-badge">
                <span>Ïã§ÏãúÍ∞Ñ Í≥ÑÏÇ∞</span>
            </div>
            <h1 class="simulator-title">Î≥µÎ¶¨ Î∞∞Îãπ ÏãúÎÆ¨Î†àÏù¥ÌÑ∞</h1>
            <p class="simulator-subtitle">
                Î∞∞ÎãπÍ∏àÏùÑ Ïû¨Ìà¨ÏûêÌïòÎ©¥ ÎÇ¥ ÏûêÏÇ∞Ïù¥ Ïñ¥ÎñªÍ≤å Î∂àÏñ¥ÎÇ†ÍπåÏöî?<br>
                ÎãπÏã†ÎßåÏùò Í≤ΩÏ†úÏ†Å ÏûêÏú† Î°úÎìúÎßµÏùÑ Í∑∏Î†§Î≥¥ÏÑ∏Ïöî.
            </p>
        </header>

        <!-- Main Card -->
        <div class="simulator-card">
            <!-- Input Section -->
            <div class="input-section">
                <div class="input-grid">
                    <div class="input-group">
                        <label class="input-label">
                            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 6v6l4 2"/>
                            </svg>
                            Ï¥àÍ∏∞ Ìà¨ÏûêÍ∏à
                        </label>
                        <div class="input-wrapper">
                            <span class="input-prefix">‚Ç©</span>
                            <input type="text" id="principal" class="simulator-input has-prefix" 
                                   value="10,000,000" placeholder="10,000,000">
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">
                            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2v20M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6"/>
                            </svg>
                            Ïõî Ï∂îÍ∞Ä Ìà¨Ïûê
                        </label>
                        <div class="input-wrapper">
                            <span class="input-prefix">‚Ç©</span>
                            <input type="text" id="monthly" class="simulator-input has-prefix" 
                                   value="500,000" placeholder="500,000">
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="input-label tooltip" data-tooltip="Ïó∞Í∞Ñ Î∞∞Îãπ ÏàòÏùµÎ•† (ÏÑ∏Ï†Ñ)">
                            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                            </svg>
                            Î∞∞Îãπ ÏàòÏùµÎ•†
                        </label>
                        <div class="input-wrapper">
                            <input type="number" id="dividend-rate" class="simulator-input has-suffix" 
                                   value="5" step="0.1" min="0" max="20">
                            <span class="input-suffix">%</span>
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="input-label tooltip" data-tooltip="ÏòàÏÉÅ Ïó∞Í∞Ñ Ï£ºÍ∞Ä ÏÉÅÏäπÎ•†">
                            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/>
                                <polyline points="17 6 23 6 23 12"/>
                            </svg>
                            Ï£ºÍ∞Ä ÏÉÅÏäπÎ•†
                        </label>
                        <div class="input-wrapper">
                            <input type="number" id="growth-rate" class="simulator-input has-suffix" 
                                   value="3" step="0.1" min="-10" max="30">
                            <span class="input-suffix">%</span>
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">
                            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                                <line x1="16" y1="2" x2="16" y2="6"/>
                                <line x1="8" y1="2" x2="8" y2="6"/>
                                <line x1="3" y1="10" x2="21" y2="10"/>
                            </svg>
                            Ìà¨Ïûê Í∏∞Í∞Ñ
                        </label>
                        <div class="input-wrapper">
                            <input type="number" id="years" class="simulator-input has-suffix" 
                                   value="10" min="1" max="50">
                            <span class="input-suffix">ÎÖÑ</span>
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="input-label tooltip" data-tooltip="Î∞∞ÎãπÏÜåÎìùÏÑ∏ 15.4% (ÌïúÍµ≠ Í∏∞Ï§Ä)">
                            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/>
                                <polyline points="14 2 14 8 20 8"/>
                                <line x1="16" y1="13" x2="8" y2="13"/>
                                <line x1="16" y1="17" x2="8" y2="17"/>
                            </svg>
                            Î∞∞Îãπ ÏÑ∏Ïú®
                        </label>
                        <div class="input-wrapper">
                            <input type="number" id="tax-rate" class="simulator-input has-suffix" 
                                   value="15.4" step="0.1" min="0" max="50">
                            <span class="input-suffix">%</span>
                        </div>
                    </div>
                </div>

                <!-- Preset Buttons -->
                <div class="preset-section">
                    <div class="preset-label">‚ö° Îπ†Î•∏ ÏÑ§Ï†ï (Ïù∏Í∏∞ Î∞∞ÎãπÏ£º ÌèâÍ∑† ÏàòÏùµÎ•†)</div>
                    <div class="preset-buttons">
                        <button class="preset-btn" onclick="setPreset('schd')">SCHD (3.5%)</button>
                        <button class="preset-btn" onclick="setPreset('o')">Î¶¨ÏñºÌã∞Ïù∏Ïª¥ (5.5%)</button>
                        <button class="preset-btn" onclick="setPreset('jepi')">JEPI (7.5%)</button>
                        <button class="preset-btn" onclick="setPreset('qyld')">QYLD (11%)</button>
                    </div>
                </div>

                <button class="calculate-btn" onclick="calculate()">
                    üöÄ ÎÇ¥ Î∞∞Îãπ ÎØ∏Îûò Í≥ÑÏÇ∞ÌïòÍ∏∞
                </button>
            </div>

            <!-- Results Section -->
            <div class="results-section" id="results">
                <div class="results-header">
                    <h2 class="results-title">üìä ÏãúÎÆ¨Î†àÏù¥ÏÖò Í≤∞Í≥º</h2>
                    <span class="results-period" id="period-display">10ÎÖÑ ÌõÑ</span>
                </div>

                <!-- Monthly Dividend Highlight -->
                <div class="monthly-section">
                    <div class="monthly-label">üéØ Î™©Ìëú Îã¨ÏÑ± Ïãú ÏòàÏÉÅ Ïõî Î∞∞ÎãπÍ∏à (ÏÑ∏ÌõÑ)</div>
                    <div class="monthly-value" id="monthly-dividend">‚Ç©0</div>
                    <div class="monthly-note">Îß§Îã¨ ÌÜµÏû•Ïóê Îì§Ïñ¥Ïò§Îäî Í∏àÏï°</div>
                </div>

                <!-- Result Cards -->
                <div class="results-grid">
                    <div class="result-card highlight">
                        <div class="result-label">Ï¥ù ÏûêÏÇ∞Í∞ÄÏπò</div>
                        <div class="result-value" id="total-value">‚Ç©0</div>
                        <div class="result-change" id="total-return">+0%</div>
                    </div>
                    <div class="result-card">
                        <div class="result-label">Ï¥ù Ìà¨ÏûêÏõêÍ∏à</div>
                        <div class="result-value" id="total-invested">‚Ç©0</div>
                    </div>
                    <div class="result-card">
                        <div class="result-label">ÎàÑÏ†Å Î∞∞ÎãπÍ∏à</div>
                        <div class="result-value" id="total-dividends">‚Ç©0</div>
                    </div>
                    <div class="result-card">
                        <div class="result-label">Î≥µÎ¶¨ ÏàòÏùµ</div>
                        <div class="result-value" id="compound-gain">‚Ç©0</div>
                    </div>
                </div>

                <!-- Chart -->
                <div class="chart-container">
                    <div class="chart-header">
                        <span class="chart-title">Ïó∞ÎèÑÎ≥Ñ ÏûêÏÇ∞ ÏÑ±Ïû• Ï∂îÏù¥</span>
                        <div class="chart-legend">
                            <div class="legend-item">
                                <span class="legend-dot principal"></span>
                                <span>ÏõêÍ∏à</span>
                            </div>
                            <div class="legend-item">
                                <span class="legend-dot dividend"></span>
                                <span>Î∞∞Îãπ Ïû¨Ìà¨Ïûê</span>
                            </div>
                        </div>
                    </div>
                    <div class="chart-area">
                        <div class="chart-bars" id="chart-bars"></div>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <footer class="simulator-footer">
                <div class="footer-info">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <line x1="12" y1="16" x2="12" y2="12"/>
                        <line x1="12" y1="8" x2="12.01" y2="8"/>
                    </svg>
                    <span>Ìà¨ÏûêÏóêÎäî ÏõêÍ∏à ÏÜêÏã§Ïùò ÏúÑÌóòÏù¥ ÏûàÏäµÎãàÎã§. Í≥ºÍ±∞ ÏàòÏùµÎ•†Ïù¥ ÎØ∏ÎûòÎ•º Î≥¥Ïû•ÌïòÏßÄ ÏïäÏäµÎãàÎã§.</span>
                </div>
                <div class="footer-update">Last Updated: <span id="update-date"></span></div>
            </footer>
        </div>
    </div>

    <script>
        // Format number with commas
        function formatNumber(num) {
            return Math.round(num).toLocaleString('ko-KR');
        }

        // Parse formatted number
        function parseFormattedNumber(str) {
            return parseInt(str.replace(/[^\d]/g, '')) || 0;
        }

        // Format input on blur
        document.querySelectorAll('#principal, #monthly').forEach(input => {
            input.addEventListener('blur', function() {
                const value = parseFormattedNumber(this.value);
                this.value = formatNumber(value);
            });
            input.addEventListener('focus', function() {
                const value = parseFormattedNumber(this.value);
                this.value = value || '';
            });
        });

        // Preset configurations
        function setPreset(type) {
            const presets = {
                'schd': { dividend: 3.5, growth: 8 },
                'o': { dividend: 5.5, growth: 3 },
                'jepi': { dividend: 7.5, growth: 2 },
                'qyld': { dividend: 11, growth: 0 }
            };
            
            const preset = presets[type];
            document.getElementById('dividend-rate').value = preset.dividend;
            document.getElementById('growth-rate').value = preset.growth;
            
            // Highlight selected preset
            document.querySelectorAll('.preset-btn').forEach(btn => {
                btn.style.borderColor = '';
                btn.style.color = '';
            });
            event.target.style.borderColor = 'var(--accent-green)';
            event.target.style.color = 'var(--accent-green)';
        }

        // Main calculation
        function calculate() {
            const principal = parseFormattedNumber(document.getElementById('principal').value);
            const monthlyAdd = parseFormattedNumber(document.getElementById('monthly').value);
            const dividendRate = parseFloat(document.getElementById('dividend-rate').value) / 100;
            const growthRate = parseFloat(document.getElementById('growth-rate').value) / 100;
            const years = parseInt(document.getElementById('years').value);
            const taxRate = parseFloat(document.getElementById('tax-rate').value) / 100;

            let currentValue = principal;
            let totalInvested = principal;
            let totalDividends = 0;
            const yearlyData = [{ year: 0, principal: principal, dividend: 0, total: principal }];

            // Calculate year by year
            for (let year = 1; year <= years; year++) {
                // Add monthly investments
                for (let month = 0; month < 12; month++) {
                    currentValue += monthlyAdd;
                    totalInvested += monthlyAdd;
                    
                    // Monthly dividend (reinvested after tax)
                    const monthlyDividend = currentValue * (dividendRate / 12);
                    const afterTaxDividend = monthlyDividend * (1 - taxRate);
                    currentValue += afterTaxDividend;
                    totalDividends += afterTaxDividend;
                    
                    // Monthly growth
                    currentValue *= (1 + growthRate / 12);
                }

                yearlyData.push({
                    year: year,
                    principal: totalInvested,
                    dividend: totalDividends,
                    total: currentValue
                });
            }

            // Calculate final monthly dividend (after tax)
            const finalMonthlyDividend = currentValue * (dividendRate / 12) * (1 - taxRate);
            const compoundGain = currentValue - totalInvested;
            const totalReturn = ((currentValue - totalInvested) / totalInvested * 100).toFixed(1);

            // Update UI
            document.getElementById('monthly-dividend').textContent = '‚Ç©' + formatNumber(finalMonthlyDividend);
            document.getElementById('total-value').textContent = '‚Ç©' + formatNumber(currentValue);
            document.getElementById('total-invested').textContent = '‚Ç©' + formatNumber(totalInvested);
            document.getElementById('total-dividends').textContent = '‚Ç©' + formatNumber(totalDividends);
            document.getElementById('compound-gain').textContent = '‚Ç©' + formatNumber(compoundGain);
            document.getElementById('total-return').textContent = '+' + totalReturn + '%';
            document.getElementById('period-display').textContent = years + 'ÎÖÑ ÌõÑ';

            // Draw chart
            drawChart(yearlyData);

            // Show results
            document.getElementById('results').classList.add('active');
            
            // Scroll to results
            document.getElementById('results').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // Draw bar chart
        function drawChart(data) {
            const container = document.getElementById('chart-bars');
            container.innerHTML = '';
            
            const maxValue = Math.max(...data.map(d => d.total));
            const step = Math.max(1, Math.floor(data.length / 10));
            
            data.forEach((d, i) => {
                if (i % step !== 0 && i !== data.length - 1) return;
                
                const principalHeight = (d.principal / maxValue) * 160;
                const dividendHeight = ((d.total - d.principal) / maxValue) * 160;
                
                const group = document.createElement('div');
                group.className = 'bar-group';
                
                const barStack = document.createElement('div');
                barStack.style.display = 'flex';
                barStack.style.flexDirection = 'column-reverse';
                barStack.style.width = '100%';
                barStack.style.height = '180px';
                barStack.style.alignItems = 'center';
                barStack.style.justifyContent = 'flex-start';
                
                const principalBar = document.createElement('div');
                principalBar.className = 'bar principal';
                principalBar.style.height = principalHeight + 'px';
                principalBar.style.width = '100%';
                
                const dividendBar = document.createElement('div');
                dividendBar.className = 'bar dividend';
                dividendBar.style.height = Math.max(0, dividendHeight) + 'px';
                dividendBar.style.width = '100%';
                dividendBar.style.borderRadius = '4px 4px 0 0';
                
                barStack.appendChild(principalBar);
                barStack.appendChild(dividendBar);
                
                const label = document.createElement('span');
                label.className = 'bar-label';
                label.textContent = d.year + 'ÎÖÑ';
                
                group.appendChild(barStack);
                group.appendChild(label);
                container.appendChild(group);
            });
        }

        // Set today's date
        document.getElementById('update-date').textContent = new Date().toISOString().split('T')[0];

        // Initial calculation
        calculate();
    </script>
</body>
</html>
